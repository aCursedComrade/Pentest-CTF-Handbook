#Web 

# Authentication Vulnerabilities

### Password-based
Often times, this kind of authentication is targeted by social engineering attempts (like phishing) and brute-force attacks. Attackers are required to enumerate based on the user account they are trying to compromise by **analysing publicly available information (internet profiles, usernames, emails and so on**). As users, they can also be negligible regarding their security, such as **using weak guessable passwords**.

Other than users, web applications may expose certain hints/weakness that can help attackers with enumeration. Such as, when enumerating usernames by an automated brute-force, attackers look for subtle differences in the web application (**response time, body, length, headers, etc**) that occur due to logic flaws or misconfigurations. This also applies when attempting to brute-force passwords as well.

About brute-force protection:
- Websites may block IP addresses to stop further attacks from happening. This can be countered with certain steps such as, **using "X-Forwarded-For:" header** to spoof origin IP, trying to **log in to a legitimate (your) account** to see if the ban is lifted, trying to within the minimum number of applicable fail attempts.
- On the other hand, account locking mechanism can be used to enumerate valid accounts/usernames.
- When rate limitations are in place, the attack has to be fine-tuned to not bombard the server with large number of requests per second.
- If data is handled as JSON values, attacker can attempt to send multiple values as an array for a single key/object within a single request.
- Paying attention header values (cookies, tokens, etc) to see if they are weakly encoded and potentially reveal sensitive that can leveraged to gain some sort of access or lead to other exploitation.

### Multi-Factor Authentication Flaws
Few points to look out for when testing MFA system;
- The logic itself is crucial in this case, the developer needs to properly implement the MFA so that there are not any logical bugs to abused.
- One, is to see the user in a **logged in state** before MFA is confirmed. If so, can the user request a resource without completing the MFA step?
- Another is to see **cookie values or a header values which represents the user trying to login**, to check If this can be manipulated to login as a different user with another legitimate account.
- Brute-force protection should also be implemented to stop attackers from trying this attack. Most basic defensive logic can be circumvented with **macros**.

### Other Related Mechanisms
#### "Remember Me" or similar cookies/tokens
- It is important to make these kind of cookies/tokens hard to guess.
- Anyone can try to deduce how the cookie is generated by making multiple "dummy" accounts or by chaining other vulnerabilities like **XSS** or **social engineering** to steal other users' cookies.
- If not properly obfuscated, these cookies **can be brute-forced/crafted** to match that of other users, **extract sensitive information** like hashed password (or worse, a plain text pass).

#### Resetting User Password
- Using insecure channels;
	- These can be fallen in to man-in-the-middle attacks if the transportation layer is not very secured.
	- These channels include e-mails, SMS, and similar services.
	- More over its not secure to send persistent password in these channels in case an attacker has access to user's e-mails or devices.
- Using URLs with a unique tokens
	- As tokens, again these should be securely generated and destroyed when the process is done.
	- When testing tokens, its handling process (whether the token is identified and processed correctly) and its strength (if its possible to be decoded or if it can be crafted) needs to be checked.
	- If the URL can be generated dynamically by some input (given by user, request headers), it may be vulnerable to a password reset poisoning attack;
		- Inputs can be taken from user provided data or request headers at the time of making a password reset request.
		- `Host` and `X-Forwarded-For` can be susceptible to this kind of an attack which cause the reset URL to point to an attacker controlled endpoint which can be used to steal the token (once the link is clicked/fetched in some way, even by automated apps).
		- If the input is not sanitized properly, the generated message can be susceptible to a **dangling markup attack**. This is achieved by placing a crafted *incomplete* HTML tag thats referencing/linking the attacker's endpoint.[^1]

#### Changing User Password
- Quite uncommon yet another possible endpoint that can be tested, password change lie within the user's profile. The users's current password and a new password (often required to enter twice) is needed to change a user password.
- Even when not visible, there can be basic identifiers which contains information about which user's password is being changed. If present, these forms acts quite similar to a login form.
- When such forms exists without much protection, an attacker may use an account made by them and use this feature to brute-force password to known users (or vise-versa).

### OAuth 2.0
> OAuth is a commonly used authorization framework that enables websites and web applications to request limited access to a user's account on another application. Crucially, OAuth allows the user to grant this access without exposing their login credentials to the requesting application. This means users can fine-tune which data they want to share rather than having to hand over full control of their account to a third party.

- [OAuth 2.0 Vulnerabilities - PortSwigger](https://portswigger.net/web-security/oauth)
- [OAuth Grant Types - PortSwigger](https://portswigger.net/web-security/oauth/grant-types)

[^1]: [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)

